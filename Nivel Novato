#include <stdio.h>
#include <string.h>
#include <stdlib.h>

// Struct para armazenar as informa√ß√µes de um item.
// Campos: nome (m√°x 30), tipo (m√°x 20) e quantidade.
typedef struct {
    char nome[30];
    char tipo[20];
    int quantidade;
} Item;

// Vetor de structs para armazenar at√© 10 itens (a mochila).
Item inventario[10];
// Vari√°vel para rastrear a quantidade atual de itens no invent√°rio.
int numItens = 0;



/**
 * @brief Adiciona um novo item ao invent√°rio.
 * * Permite o cadastro de um novo item (nome, tipo, quantidade) 
 * no primeiro espa√ßo livre do vetor de structs, respeitando o limite (10).
 */
void inserirItem() {
    // Verifica se a mochila est√° cheia
    if (numItens >= 10) {
        printf("\nüö´ Invent√°rio cheio! (Limite: 10 itens)\n");
        return;
    }

    printf("\n--- ‚ûï Cadastrar Novo Item ---\n");
    
    // Leitura do Nome (com prote√ß√£o contra buffer)
    printf("Nome do Item (max 29 caracteres): ");
    // Limpa o buffer antes de ler a string
    int c;
    while ((c = getchar()) != '\n' && c != EOF); 
    if (fgets(inventario[numItens].nome, 30, stdin) != NULL) {
        // Remove o '\n' lido pelo fgets, se presente
        inventario[numItens].nome[strcspn(inventario[numItens].nome, "\n")] = 0;
    }

    // Leitura do Tipo
    printf("Tipo (ex: arma, municao, cura): ");
    if (fgets(inventario[numItens].tipo, 20, stdin) != NULL) {
        // Remove o '\n' lido pelo fgets, se presente
        inventario[numItens].tipo[strcspn(inventario[numItens].tipo, "\n")] = 0;
    }

    // Leitura da Quantidade
    printf("Quantidade: ");
    if (scanf("%d", &inventario[numItens].quantidade) != 1) {
        printf("‚ö†Ô∏è Entrada inv√°lida para quantidade. Cadastro cancelado.\n");
        // Decrementa numItens caso a leitura falhe (seria incrementado no final)
        return; 
    }

    // Incrementa o contador, pois o item foi cadastrado com sucesso
    numItens++; 
    printf("\n‚úÖ Item '%s' cadastrado com sucesso! Espa√ßos restantes: %d\n", 
           inventario[numItens - 1].nome, 10 - numItens);
}

/**
 * @brief Remove um item do invent√°rio pelo nome.
 * * Utiliza busca sequencial para encontrar o item. Se encontrado, 
 * move os itens subsequentes uma posi√ß√£o para tr√°s para cobrir o buraco.
 */
void removerItem() {
    if (numItens == 0) {
        printf("\n‚ùå Invent√°rio vazio. N√£o h√° itens para remover.\n");
        return;
    }

    char nomeBusca[30];
    printf("\n--- üóëÔ∏è Remover Item ---\n");
    printf("Digite o NOME do item a ser removido: ");
    // Limpa o buffer antes de ler a string
    int c;
    while ((c = getchar()) != '\n' && c != EOF); 
    if (fgets(nomeBusca, 30, stdin) != NULL) {
        // Remove o '\n' lido pelo fgets, se presente
        nomeBusca[strcspn(nomeBusca, "\n")] = 0;
    }

    int i, encontrado = 0;
    // Percorre o vetor para buscar o item
    for (i = 0; i < numItens; i++) {
        // Compara o nome do item na posi√ß√£o 'i' com o nome de busca
        if (strcmp(inventario[i].nome, nomeBusca) == 0) {
            encontrado = 1;
            break; // Item encontrado na posi√ß√£o 'i'
        }
    }

    if (encontrado) {
        printf("‚úÖ Item '%s' encontrado e removido.\n", inventario[i].nome);
        
        // Deslocamento: move todos os itens a partir da posi√ß√£o 'i+1' 
        // uma posi√ß√£o para a esquerda, sobrescrevendo o item removido.
        for (int j = i; j < numItens - 1; j++) {
            inventario[j] = inventario[j + 1];
        }

        // Decrementa o n√∫mero total de itens
        numItens--;
    } else {
        printf("\n‚ö†Ô∏è Item '%s' n√£o encontrado no invent√°rio.\n", nomeBusca);
    }
}

/**
 * @brief Exibe todos os itens cadastrados no invent√°rio.
 * * Lista de forma organizada o nome, tipo e quantidade de cada item.
 */
void listarItens() {
    printf("\n--- üì¶ Invent√°rio Atual (Itens: %d/10) ---\n", numItens);
    
    if (numItens == 0) {
        printf("A mochila est√° vazia. Colete alguns itens!\n");
        return;
    }

    printf("+------------------------------+--------------------+--------------+\n");
    printf("| Nome do Item                 | Tipo               | Quantidade   |\n");
    printf("+------------------------------+--------------------+--------------+\n");

    // Percorre o vetor e imprime os dados de cada item
    for (int i = 0; i < numItens; i++) {
        printf("| %-28s | %-18s | %-12d |\n", 
               inventario[i].nome, inventario[i].tipo, inventario[i].quantidade);
    }
    printf("+------------------------------+--------------------+--------------+\n");
}

/**
 * @brief Implementa a busca sequencial por nome.
 * * Percorre o vetor do in√≠cio ao fim para encontrar um item espec√≠fico.
 */
void buscarItem() {
    if (numItens == 0) {
        printf("\n‚ùå Invent√°rio vazio. N√£o h√° itens para buscar.\n");
        return;
    }

    char nomeBusca[30];
    printf("\n--- üîç Buscar Item ---\n");
    printf("Digite o NOME do item para buscar: ");
    // Limpa o buffer antes de ler a string
    int c;
    while ((c = getchar()) != '\n' && c != EOF);
    if (fgets(nomeBusca, 30, stdin) != NULL) {
        // Remove o '\n' lido pelo fgets, se presente
        nomeBusca[strcspn(nomeBusca, "\n")] = 0;
    }

    int encontrado = 0;
    
    // Busca sequencial: percorre o vetor posi√ß√£o por posi√ß√£o
    for (int i = 0; i < numItens; i++) {
        // Compara o nome atual com o nome de busca
        if (strcmp(inventario[i].nome, nomeBusca) == 0) {
            encontrado = 1;
            printf("\n--- üéØ Item Encontrado ---\n");
            printf("Nome:       %s\n", inventario[i].nome);
            printf("Tipo:       %s\n", inventario[i].tipo);
            printf("Quantidade: %d\n", inventario[i].quantidade);
            printf("---------------------------\n");
            break; // Item encontrado, pode sair do la√ßo
        }
    }

    if (!encontrado) {
        printf("\n‚ö†Ô∏è Item '%s' n√£o encontrado na mochila.\n", nomeBusca);
    }
}


// --- 3. Fun√ß√£o Principal (Menu e Fluxo de Execu√ß√£o) ---
int main() {
    int opcao;

    printf("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n");
    printf("‚ïë         üéÆ Sistema de Invent√°rio (Mochila)      ‚ïë\n");
    printf("‚ïë      Recursos Essenciais: Organiza√ß√£o de Dados   ‚ïë\n");
    printf("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n");
    
    do {
        // Usabilidade: Menu claro e orientativo
        listarItens(); // Listagem ap√≥s cada opera√ß√£o

        printf("\n--- Escolha sua A√ß√£o ---\n");
        printf("1. ‚ûï Cadastrar Novo Item\n");
        printf("2. üóëÔ∏è Remover Item (por Nome)\n");
        printf("3. üîç Buscar Item (por Nome)\n");
        printf("0. üö™ Sair do Jogo\n");
        printf("Op√ß√£o: ");
        
        // Leitura da op√ß√£o
        if (scanf("%d", &opcao) != 1) {
            printf("‚ö†Ô∏è Entrada inv√°lida. Tente novamente.\n");
            // Limpa o buffer de entrada em caso de erro
            while (getchar() != '\n'); 
            opcao = -1; // Garante que o loop continue
            continue;
        }

        switch (opcao) {
            case 1:
                inserirItem();
                break;
            case 2:
                removerItem();
                break;
            case 3:
                buscarItem();
                break;
            case 0:
                printf("\nüëã Fechando a mochila. Jogo encerrado.\n");
                break;
            default:
                printf("\nOp√ß√£o inv√°lida. Tente novamente.\n");
        }
    } while (opcao != 0);

    return 0;
}